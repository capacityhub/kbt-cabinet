(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1afe93a8","chunk-0433b54e"],{"0a49":function(e,t,r){var n=r("9b43"),o=r("626a"),i=r("4bf8"),a=r("9def"),s=r("cd1c");e.exports=function(e,t){var r=1==e,l=2==e,c=3==e,f=4==e,u=6==e,d=5==e||u,m=t||s;return function(t,s,g){for(var p,h,v=i(t),b=o(v),w=n(s,g,3),x=a(b.length),_=0,A=r?m(t,x):l?m(t,0):void 0;x>_;_++)if((d||_ in b)&&(p=b[_],h=w(p,_,v),e))if(r)A[_]=h;else if(h)switch(e){case 3:return!0;case 5:return p;case 6:return _;case 2:A.push(p)}else if(f)return!1;return u?-1:c||f?f:A}}},1169:function(e,t,r){var n=r("2d95");e.exports=Array.isArray||function(e){return"Array"==n(e)}},"268f":function(e,t,r){e.exports=r("fde4")},"28a5":function(e,t,r){r("214f")("split",2,function(e,t,n){"use strict";var o=r("aae3"),i=n,a=[].push,s="split",l="length",c="lastIndex";if("c"=="abbc"[s](/(b)*/)[1]||4!="test"[s](/(?:)/,-1)[l]||2!="ab"[s](/(?:ab)*/)[l]||4!="."[s](/(.?)(.?)/)[l]||"."[s](/()()/)[l]>1||""[s](/.?/)[l]){var f=void 0===/()??/.exec("")[1];n=function(e,t){var r=String(this);if(void 0===e&&0===t)return[];if(!o(e))return i.call(r,e,t);var n,s,u,d,m,g=[],p=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),h=0,v=void 0===t?4294967295:t>>>0,b=new RegExp(e.source,p+"g");f||(n=new RegExp("^"+b.source+"$(?!\\s)",p));while(s=b.exec(r)){if(u=s.index+s[0][l],u>h&&(g.push(r.slice(h,s.index)),!f&&s[l]>1&&s[0].replace(n,function(){for(m=1;m<arguments[l]-2;m++)void 0===arguments[m]&&(s[m]=void 0)}),s[l]>1&&s.index<r[l]&&a.apply(g,s.slice(1)),d=s[0][l],h=u,g[l]>=v))break;b[c]===s.index&&b[c]++}return h===r[l]?!d&&b.test("")||g.push(""):g.push(r.slice(h)),g[l]>v?g.slice(0,v):g}}else"0"[s](void 0,0)[l]&&(n=function(e,t){return void 0===e&&0===t?[]:i.call(this,e,t)});return[function(r,o){var i=e(this),a=void 0==r?void 0:r[t];return void 0!==a?a.call(r,i,o):n.call(String(i),r,o)},n]})},"28d8":function(e,t,r){},"32a6":function(e,t,r){var n=r("241e"),o=r("c3a1");r("ce7e")("keys",function(){return function(e){return o(n(e))}})},"70c2":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-form",{ref:"form",staticClass:"form",attrs:{model:e.form,"label-width":"120px",rules:e.rules,disabled:e.disableAll}},[r("div",{staticClass:"form-title"},[e._v("基本信息")]),e._v(" "),r("el-form-item",{attrs:{label:"应用名称",prop:"name"}},[r("el-input",{attrs:{placeholder:"请输入名称",maxlength:"20"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}}),e._v(" "),r("div",{staticClass:"input-info-text"},[e._v("长度不可超过20个字符")])],1),e._v(" "),r("el-form-item",{attrs:{label:"应用简介",prop:"profile"}},[r("el-input",{attrs:{type:"textarea",autosize:"",placeholder:"请输入应用简介",maxlength:"100"},model:{value:e.form.profile,callback:function(t){e.$set(e.form,"profile",t)},expression:"form.profile"}}),e._v(" "),r("div",{staticClass:"input-info-text"},[e._v("长度不可超过100个字符")])],1),e._v(" "),r("el-form-item",{attrs:{label:"应用来源",prop:"channel"}},[r("el-input",{attrs:{placeholder:"请输入应用来源",maxlength:"20"},model:{value:e.form.channel,callback:function(t){e.$set(e.form,"channel",t)},expression:"form.channel"}}),e._v(" "),r("div",{staticClass:"input-info-text"},[e._v("长度不可超过20个字符")])],1),e._v(" "),r("div",{staticClass:"form-line"}),e._v(" "),r("div",{staticClass:"form-title"},[e._v("应用信息")]),e._v(" "),r("el-form-item",{attrs:{label:"应用首页地址",prop:"applicationUrl"}},[r("el-input",{attrs:{placeholder:"请输入地址，如http://www.baidu.com"},model:{value:e.form.applicationUrl,callback:function(t){e.$set(e.form,"applicationUrl",t)},expression:"form.applicationUrl"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"发布类型",prop:"onlineType"}},[r("el-radio-group",{model:{value:e.form.onlineType,callback:function(t){e.$set(e.form,"onlineType",t)},expression:"form.onlineType"}},[r("el-radio",{attrs:{label:"0"}},[e._v("手动上架")])],1)],1),e._v(" "),r("div",{staticClass:"form-line"}),e._v(" "),r("div",{staticClass:"form-title"},[e._v("图标素材")]),e._v(" "),r("el-form-item",{attrs:{label:"应用图标",required:!0}},[r("el-upload",{class:e.showLogoWarning?"logo-upload logo-upload-warning":"logo-upload",attrs:{action:e.uploadFileUrl,"show-file-list":!1,"on-success":e.logoUploadSuccess,"on-error":e.uploadError,"before-upload":e.beforeLogoUpload}},[e.form.logoUrl?r("img",{attrs:{src:e.form.logoUrl}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),e._v(" "),e.form.logoUrl&&!e.disableAll?r("div",{staticClass:"logo-update"},[e._v("修改")]):e._e()]),e._v(" "),e.showLogoWarning?r("div",{staticClass:"logo-warning"},[e._v(e._s(e.showLogoWarning))]):e._e(),e._v(" "),r("div",{staticClass:"img-prompt"},[e._v("图片格式必须为bmp、jpeg、jpg、png，大小在200k以内，建议图片尺寸为152*152")])],1),e._v(" "),!e.disableAll||e.disableAll&&e.imageUrl[0]?r("el-form-item",{attrs:{label:"应用预览图",required:!0}},[r("div",{staticClass:"preview-img"},e._l(e.imageUrl,function(t,n){return!e.disableAll||e.disableAll&&""!=t?r("el-upload",{key:n,class:e.showPreviewWarning?"img-upload logo-upload-warning":"img-upload",attrs:{action:e.uploadFileUrl,multiple:!1,"show-file-list":!1,"on-success":function(t){return e.handleImgSuccess(t,n)},"on-error":e.uploadError,"before-upload":e.beforeImgUpload}},[e.imageUrl[n]?r("img",{attrs:{src:e.imageUrl[n]}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"}),e._v(" "),e.imageUrl[n]&&!e.disableAll?r("div",{staticClass:"img-delete",on:{click:function(t){t.stopPropagation(),e.deleteImg(n)}}},[e._v("删除")]):e._e()]):e._e()})),e._v(" "),e.showPreviewWarning?r("div",{staticClass:"logo-warning"},[e._v(e._s(e.showPreviewWarning))]):e._e(),e._v(" "),r("div",{staticClass:"img-prompt"},[e._v("图片格式必须为bmp、jpeg、jpg、png，不可大于2M，建议图片尺寸为480*800或720*1280")])]):e._e()],1)},o=[],i=(r("6b54"),r("28a5"),r("7f7f"),r("7514"),r("cebc")),a=r("365c"),s=r("2f62"),l={name:"app-info",data:function(){return{form:{},arranges:[{id:0,name:"热门应用"},{id:1,name:"系统应用"}],uploadFileUrl:a["bb"],imageUrl:[""],rules:{name:[{required:!0,message:"请输入应用名称",trigger:"blur"},{max:20,message:"长度不可超出20个字符",trigger:"blur"}],applicationUrl:[{required:!0,message:"请输入应用地址",trigger:"blur"}],profile:[{required:!0,message:"请输入应用简介",trigger:"blur"},{max:100,message:"长度不可超出100个字符",trigger:"blur"}],channel:[{required:!0,message:"请选择应用来源",trigger:"blur"},{max:20,message:"长度不可超出20个字符",trigger:"blur"}],onlineType:[{required:!0,message:"请选择上线类型",trigger:"change"}]},showLogoWarning:"",showPreviewWarning:"",disableAll:!1}},props:["formData","disabled"],created:function(){this.disabled?this.disableAll=this.disabled:this.getArrangeLists(),this.form=this.formData,this.setData()},watch:{formData:{handler:function(e,t){this.form=e,this.setData()},deep:!0}},computed:Object(i["a"])({},Object(s["d"])({arrangeList:function(e){return e.arrange.arrangeList}}),{getArrangeName:function(){var e=this,t=this.arranges.find(function(t){return t.id==e.form.arrangeId});return t.name}}),methods:Object(i["a"])({},Object(s["b"])({GetArrangeList:"arrange/GetArrangeList"}),{setData:function(){this.form.previewImg&&""!=this.form.previewImg&&(this.imageUrl=this.form.previewImg.split(";").filter(function(e){return""!=e})),this.$set(this.form,"onlineType",this.form.onlineType.toString()),this.form.arrangeId||this.$set(this.form,"arrangeId",this.arranges[0].id)},getArrangeLists:function(){var e=this;this.GetArrangeList().then(function(t){200==t&&(e.arranges=e.arrangeList)})},logoUploadSuccess:function(e,t){this.form.logoUrl=e.result,this.showLogoWarning=""},beforeLogoUpload:function(e){var t=e.type,r=-1!=t.indexOf("jpeg")||-1!=t.indexOf("jpg")||-1!=t.indexOf("png")||-1!=t.indexOf("bmp"),n=e.size/1024<200;return r||(this.showLogoWarning="上传的图片必须是png,jpg,jpeg，bmp格式"),n||(this.showLogoWarning="上传的图片大小不能超过200KB"),r&&n},handleImgSuccess:function(e,t){this.$set(this.imageUrl,t,e.result),this.imageUrl.length>0&&(this.form.previewImg=this.imageUrl.join(";"))},beforeImgUpload:function(e){var t=e.type,r=-1!=t.indexOf("jpeg")||-1!=t.indexOf("jpg")||-1!=t.indexOf("png")||-1!=t.indexOf("bmp"),n=e.size/1024/1024<2;return r||this.$message.error("上传的图片必须是png,jpg,jpeg，bmp格式之一!"),n||this.$message.error("上传的图片大小不能超过2M!"),r&&n},uploadError:function(e,t,r){this.$message.error("上传图片失败!")},setArrangeName:function(e){this.form.arrangeName=this.getArrangeName},deleteImg:function(e){this.imageUrl.splice(e,1,""),this.form.previewImg=this.imageUrl.join(";")},logoImgCheck:function(){this.showLogoWarning="请上传应用图标"},previewCheck:function(){this.showPreviewWarning="请上传应用预览图"},checkForm:function(){var e=!1;this.$refs["form"].validate(function(t){e=!!t});var t=""!=this.form.logoUrl,r=""!=this.form.previewImg;return t||this.logoImgCheck(),r||this.previewCheck(),t&&r&&e},checkDraftForm:function(){var e=!1;this.$refs["form"].validateField(["name","applicationUrl"],function(t){console.log("draft -valid :",t),e=""==t});var t=""!=this.form.logoUrl;return t||this.logoImgCheck(),e&&t}})},c=l,f=(r("73a9"),r("0c7c")),u=Object(f["a"])(c,n,o,!1,null,null,null);t["default"]=u.exports},7213:function(e,t,r){},"73a9":function(e,t,r){"use strict";var n=r("7213"),o=r.n(n);o.a},7514:function(e,t,r){"use strict";var n=r("5ca1"),o=r("0a49")(5),i="find",a=!0;i in[]&&Array(1)[i](function(){a=!1}),n(n.P+n.F*a,"Array",{find:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),r("9c6c")(i)},"86f9":function(e,t,r){"use strict";var n=r("28d8"),o=r.n(n);o.a},"8aae":function(e,t,r){r("32a6"),e.exports=r("584a").Object.keys},a4bb:function(e,t,r){e.exports=r("8aae")},bf90:function(e,t,r){var n=r("36c3"),o=r("bf0b").f;r("ce7e")("getOwnPropertyDescriptor",function(){return function(e,t){return o(n(e),t)}})},cd1c:function(e,t,r){var n=r("e853");e.exports=function(e,t){return new(n(e))(t)}},ce7e:function(e,t,r){var n=r("63b6"),o=r("584a"),i=r("294c");e.exports=function(e,t){var r=(o.Object||{})[e]||Object[e],a={};a[e]=t(r),n(n.S+n.F*i(function(){r(1)}),"Object",a)}},cebc:function(e,t,r){"use strict";r.d(t,"a",function(){return f});var n=r("268f"),o=r.n(n),i=r("e265"),a=r.n(i),s=r("a4bb"),l=r.n(s),c=r("bd86");function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=l()(r);"function"===typeof a.a&&(n=n.concat(a()(r).filter(function(e){return o()(r,e).enumerable}))),n.forEach(function(t){Object(c["a"])(e,t,r[t])})}return e}},e265:function(e,t,r){e.exports=r("ed33")},e853:function(e,t,r){var n=r("d3f4"),o=r("1169"),i=r("2b4c")("species");e.exports=function(e){var t;return o(e)&&(t=e.constructor,"function"!=typeof t||t!==Array&&!o(t.prototype)||(t=void 0),n(t)&&(t=t[i],null===t&&(t=void 0))),void 0===t?Array:t}},ed33:function(e,t,r){r("014b"),e.exports=r("584a").Object.getOwnPropertySymbols},f713:function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-dialog",{attrs:{title:"创建应用",visible:e.visibleDialog,"append-to-body":!0,"close-on-press-escape":!1,"close-on-click-modal":!1,"before-close":e.beforeClose},on:{"update:visible":function(t){e.visibleDialog=t}}},[r("div",{staticClass:"add-form"},[r("AppInfo",{ref:"addInfo",staticStyle:{width:"100%"},attrs:{formData:e.form}}),e._v(" "),r("div",{staticClass:"add-btn"},[r("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("创建")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.onDraftSave}},[e._v("保留草稿")])],1)],1)])},o=[],i=r("795b"),a=r.n(i),s=r("cebc"),l=r("2f62"),c=r("70c2"),f={components:{AppInfo:c["default"]},data:function(){return{form:{name:"",profile:"",applicationUrl:"",arrangeName:"",arrangeId:"",onlineType:"0",status:"",logoUrl:"",previewImg:""},visibleDialog:!1}},props:["showCreateForm"],created:function(){this.visibleDialog=this.showCreateForm},methods:Object(s["a"])({},Object(l["b"])({AddAPP:"application/AddAPP"}),{closeAdd:function(){this.visibleDialog=!1,this.$emit("closeDialog","showCreateForm"),this.$emit("reloadList")},onSubmit:function(){var e=this;this.form=this.$refs.addInfo.form;var t=this.$refs.addInfo.checkForm();t&&this.confirmCreate().then(function(t){return t?(console.log("创建框1--\x3e 点击确认创建按钮，调用创建接口方法"),e.AddAndonline()):(console.log("创建框1--\x3e 点击保存草稿按钮，调用保存草稿接口方法"),e.draftSave())}).then(function(t){return 2===t.status?(console.log("创建框1--\x3e 创建接口执行完,判断执行结果"),200==t.code?(console.log("成功,接下来是弹框2"),e.createResult()):(e.$message.error("错误码："+t.code+"，创建应用失败"),a.a.reject("stop"))):0===t.status?(console.log("创建框1--\x3e 草稿接口执行完，判断执行结果"),200==t.code?(console.log("成功，接下来跳转列表页"),e.closeAdd(),a.a.reject("stop")):(e.$message.error("错误码："+t.code+"，保存草稿失败"),a.a.reject("stop"))):void 0}).then(function(t){t?e.closeAdd():(console.log("弹框2 返回到创建页（当前页面），清除表单数据"),e.form={name:"",profile:"",applicationUrl:"",arrangeName:"",arrangeId:"",onlineType:"0",status:"",logoUrl:"",previewImg:""},e.$refs.addInfo.imageUrl=["","",""])}).catch(function(e){})},onDraftSave:function(){var e=this;this.form=this.$refs.addInfo.form;var t=this.$refs.addInfo.checkDraftForm();t&&this.confirmDraft().then(function(t){return t?(console.log("草稿--\x3e 调用接口方法"),e.draftSave()):(console.log("草稿--\x3e 取消，不做任何其他操作"),a.a.reject())}).then(function(t){200==t.code?e.closeAdd():e.$message.error("错误码："+t.code+"，保存草稿失败")}).catch(function(e){})},AddAndonline:function(){var e=this,t=new a.a(function(t,r){e.form.status=2,e.AddAPP(e.form).then(function(e){t({status:2,code:e})})});return t},draftSave:function(){var e=this,t=new a.a(function(t,r){e.form.status=0,e.AddAPP(e.form).then(function(e){t({status:0,code:e})})});return t},confirmCreate:function(){var e=this,t=new a.a(function(t,r){e.$confirm("确定创建并上架该应用吗？","提示",{distinguishCancelAndClose:!0,confirmButtonText:"确定",cancelButtonText:"再等等，先保存"}).then(function(){t(!0)}).catch(function(e){"cancel"===e&&t(!1)})});return t},createResult:function(){var e=this,t=new a.a(function(t,r){e.$confirm("创建并上架成功","提示",{distinguishCancelAndClose:!0,confirmButtonText:"确定",cancelButtonText:"留下来继续创建"}).then(function(){t(!0)}).catch(function(e){"cancel"===e&&t(!1)})});return t},confirmDraft:function(){var e=this,t=new a.a(function(t,r){e.$confirm("确定保存该草稿吗","提示",{confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){t(!0)}).catch(function(){t(!1)})});return t},beforeClose:function(e){var t=this;this.$confirm("关闭后当前输入的所有内容会被清除，确认关闭？","提示").then(function(){t.$emit("closeDialog","showCreateForm"),e()}).catch(function(){})}})},u=f,d=(r("86f9"),r("0c7c")),m=Object(d["a"])(u,n,o,!1,null,null,null);t["default"]=m.exports},fde4:function(e,t,r){r("bf90");var n=r("584a").Object;e.exports=function(e,t){return n.getOwnPropertyDescriptor(e,t)}}}]);